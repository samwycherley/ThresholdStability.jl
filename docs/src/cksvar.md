# CKSVAR models

[ThresholdStability.jl](https://github.com/samwycherley/ThresholdStability.jl) includes tools to convert censored and kinked structural vector autoregressive ([CKSVAR](https://arxiv.org/abs/2103.12779)) models into TVAR models.

Ox code to estimate CKSVAR models is available [here](https://drive.google.com/file/d/18616WKrloMiGd3x8140f-Fk8u29na6Qb/view?usp=sharing).

```@docs
CKSVAR_to_TAR
CKSVAR_to_companion
CKSVAR_to_companionFD
```

## Construction of automata
`CKSVAR_to_TAR` outputs a set of matrices generated in an order generated by the `perms` function (as well as a set encoding state space constraints.)

`automaton_constructor` provides a method to construct an automaton suitable for use with a CKSVAR model converted using `CKSVAR_to_TAR`, assuming this order. It is also suitable for any other set of matrices that is ordered in a similar way (see examples/AR2.jl).

```@docs
perms
automaton_constructor
```

Automata can also be constructed manually using [HybridSystems.jl](https://github.com/blegat/HybridSystems.jl), which ThresholdStability re-exports.

For example, the following code constructs an automaton with three states, loops at states 1 and 3, and edges from states 1 to 2, 2 to 3, and 3 to 1, with the tail node indices as labels.
```jldoctest
using ThresholdStability

G = LightAutomaton(3)  # initializes automaton with 3 states as an edgeless graph
add_transition!(G, 1, 1, 1)
add_transition!(G, 1, 2, 1)  # adds edge from state 1 to 2, with label 1
add_transition!(G, 2, 3, 2)
add_transition!(G, 3, 3, 3)
add_transition!(G, 3, 1, 3)
G

# output

LightAutomaton{LightGraphs.SimpleGraphs.SimpleDiGraph{Int64}, LightGraphs.SimpleGraphs.SimpleEdge{Int64}}({3, 5} directed simple Int64 graph, Dict{LightGraphs.SimpleGraphs.SimpleEdge{Int64}, Dict{Int64, Int64}}(Edge 1 => 2 => Dict(2 => 1), Edge 3 => 1 => Dict(5 => 3), Edge 1 => 1 => Dict(1 => 1), Edge 3 => 3 => Dict(4 => 3), Edge 2 => 3 => Dict(3 => 2)), 5, 5)
```

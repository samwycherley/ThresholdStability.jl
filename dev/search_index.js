var documenterSearchIndex = {"docs":
[{"location":"cksvar/#CKSVAR-models","page":"CKSVAR","title":"CKSVAR models","text":"","category":"section"},{"location":"cksvar/","page":"CKSVAR","title":"CKSVAR","text":"ThresholdStability.jl includes tools to convert censored and kinked structural vector autoregressive (CKSVAR) models into TVAR models. Information on CKSVAR models is available in Mavroeidis (2021).","category":"page"},{"location":"cksvar/","page":"CKSVAR","title":"CKSVAR","text":"Ox code to estimate CKSVAR models is available here.","category":"page"},{"location":"cksvar/","page":"CKSVAR","title":"CKSVAR","text":"CKSVAR_to_TAR\nCKSVAR_to_companion\nCKSVAR_to_companionFD","category":"page"},{"location":"cksvar/#ThresholdStability.CKSVAR_to_TAR","page":"CKSVAR","title":"ThresholdStability.CKSVAR_to_TAR","text":"CKSVAR_to_TAR(C, Cstar, βtilde, nlags)\n\nReturns pair (Σ, X) where Σ is a set of matrices corresponding to the CKSVAR model (with censored variable in levels) in TVAR form, and X is a set encoding state-space constraints.\n\n\n\n\n\n","category":"function"},{"location":"cksvar/#ThresholdStability.CKSVAR_to_companion","page":"CKSVAR","title":"ThresholdStability.CKSVAR_to_companion","text":"CKSVAR_to_companion(C, Cstar, βtilde, nlags)\n\nConverts CKSVAR model (with censored variable in levels) into companion form.\n\n\n\n\n\n","category":"function"},{"location":"cksvar/#ThresholdStability.CKSVAR_to_companionFD","page":"CKSVAR","title":"ThresholdStability.CKSVAR_to_companionFD","text":"CKSVAR_to_companionFD(F, Fstar, βtilde, nlags; diff=true)\n\nConverts CKSVAR model estimated with the censored variable entering in first differences into companion form. The default setting diff=true returns the companion form with the censored variable entering in first differences. To retrieve the companion form with censored variable entering in levels, set diff=false.\n\n\n\n\n\n","category":"function"},{"location":"cksvar/#Construction-of-automata","page":"CKSVAR","title":"Construction of automata","text":"","category":"section"},{"location":"cksvar/","page":"CKSVAR","title":"CKSVAR","text":"CKSVAR_to_TAR outputs a set of matrices generated in an order generated by the perms function (as well as a set encoding state space constraints.)","category":"page"},{"location":"cksvar/","page":"CKSVAR","title":"CKSVAR","text":"automaton_constructor provides a method to construct an automaton suitable for use with a CKSVAR model converted using CKSVAR_to_TAR, assuming this order. It is also suitable for any other set of matrices that is ordered in a similar way (see examples/AR2.jl).","category":"page"},{"location":"cksvar/","page":"CKSVAR","title":"CKSVAR","text":"perms\nautomaton_constructor","category":"page"},{"location":"cksvar/#ThresholdStability.perms","page":"CKSVAR","title":"ThresholdStability.perms","text":"perms(p)\n\nGenerates a vector of all sequences of length p made up of elements -1 or 1.\n\n\n\n\n\n","category":"function"},{"location":"cksvar/#ThresholdStability.automaton_constructor","page":"CKSVAR","title":"ThresholdStability.automaton_constructor","text":"automaton_constructor(Σ::AbstractVector{<:AbstractMatrix})\n\nGenerates an automaton tracking admissible transitions between states. Σ is a vector of matrices corresponding to a TAR model, assuming a default order generated by perms.\n\nautomaton_constructor(Σ::AbstractVector{<:AbstractMatrix}, seqlist)\n\nGenerates an automaton tracking admissible transitions between states given a custom list of regime sequences.\n\n\n\n\n\n","category":"function"},{"location":"cksvar/","page":"CKSVAR","title":"CKSVAR","text":"Automata can also be constructed manually using HybridSystems.jl, which ThresholdStability re-exports.","category":"page"},{"location":"cksvar/","page":"CKSVAR","title":"CKSVAR","text":"For example, the following code constructs an automaton with three states, loops at states 1 and 3, and edges from states 1 to 2, 2 to 3, and 3 to 1, with the tail node indices as labels.","category":"page"},{"location":"cksvar/","page":"CKSVAR","title":"CKSVAR","text":"using ThresholdStability\n\nG = LightAutomaton(3)  # initializes automaton with 3 states as an edgeless graph\nadd_transition!(G, 1, 1, 1)\nadd_transition!(G, 1, 2, 1)  # adds edge from state 1 to 2, with label 1\nadd_transition!(G, 2, 3, 2)\nadd_transition!(G, 3, 3, 3)\nadd_transition!(G, 3, 1, 3)\nG\n\n# output\n\nLightAutomaton{LightGraphs.SimpleGraphs.SimpleDiGraph{Int64}, LightGraphs.SimpleGraphs.SimpleEdge{Int64}}({3, 5} directed simple Int64 graph, Dict{LightGraphs.SimpleGraphs.SimpleEdge{Int64}, Dict{Int64, Int64}}(Edge 1 => 2 => Dict(2 => 1), Edge 3 => 1 => Dict(5 => 3), Edge 1 => 1 => Dict(1 => 1), Edge 3 => 3 => Dict(4 => 3), Edge 2 => 3 => Dict(3 => 2)), 5, 5)","category":"page"},{"location":"cksvar/#Indicator","page":"CKSVAR","title":"Indicator","text":"","category":"section"},{"location":"cksvar/","page":"CKSVAR","title":"CKSVAR","text":"indicator can be used in building functions to convert models to TVAR form. Examples: CKAR(2).","category":"page"},{"location":"cksvar/","page":"CKSVAR","title":"CKSVAR","text":"indicator","category":"page"},{"location":"cksvar/#ThresholdStability.indicator","page":"CKSVAR","title":"ThresholdStability.indicator","text":"indicator(y, b; indregion=:above, ineq=:nonstrict)\n\nIndicator variable of default form mathbf1y  b. The inequality can be made strict and the direction of inequality can be reversed.\n\nArguments\n\nineq=:nonstrict (default):  calculates mathbf1y  b or mathbf1y  b.\nineq=:strict: calculates mathbf1y  b or mathbf1y  b.\nindregion=:above (default): calculates mathbf1y  b or mathbf1y  b.\nindregion=:below: calculates mathbf1y  b or mathbf1y  b.\n\n\n\n\n\n","category":"function"},{"location":"stability/#Stability","page":"Stability","title":"Stability","text":"","category":"section"},{"location":"stability/#Motivation","page":"Stability","title":"Motivation","text":"","category":"section"},{"location":"stability/","page":"Stability","title":"Stability","text":"Let mathscrX_i_i=1^m be a partition of state space mathscrXsubseteqmathbbR^p s.t. each mathscrX_i takes the form of a convex polyhedron,","category":"page"},{"location":"stability/","page":"Stability","title":"Stability","text":"mathscrX_i=xinmathbbR^pmid E_ixgeq_* 0 D_ix=0","category":"page"},{"location":"stability/","page":"Stability","title":"Stability","text":"where the inequality geq_* may be strict or weak.","category":"page"},{"location":"stability/","page":"Stability","title":"Stability","text":"The tools in ThresholdStability.jl are intended to determine whether a discrete-time model of form","category":"page"},{"location":"stability/","page":"Stability","title":"Stability","text":"beginalignx_t+1=Phi(x_t)x_t\n=sum_sigma=1^mA_sigmamathbf1x_tinmathscrX_ix_tendalign","category":"page"},{"location":"stability/","page":"Stability","title":"Stability","text":"is asymptotically stable, where mathbf1xinmathscrX_i is an indicator function and A_i are given ptimes p matrices.","category":"page"},{"location":"stability/","page":"Stability","title":"Stability","text":"Sufficient conditions for asymptotic stability, in descending order of conservativeness, are that","category":"page"},{"location":"stability/","page":"Stability","title":"Stability","text":"the joint spectral radius (JSR) of the set Sigma=A_1dotsA_m is strictly less than 1;\nthe constrained joint spectral radius (CJSR) of the constrained switched linear system (Sigma G), where G is an automaton describing the possible transitions between states, is strictly less than 1;\nthe 'state-constrained joint spectral radius' (SCJSR) of the state-dependent switched linear system (Sigma G mathscrX_i) is strictly less than 1.","category":"page"},{"location":"stability/","page":"Stability","title":"Stability","text":"In general, exact computation of the JSR, CJSR and SCJSR are NP-hard, but can be efficiently approximated via semidefinite programming or sum-of-squares programming (see e.g. Parillo and Jadbabaie, 2008).","category":"page"},{"location":"stability/#JSR-and-CJSR","page":"Stability","title":"JSR and CJSR","text":"","category":"section"},{"location":"stability/","page":"Stability","title":"Stability","text":"We provide functions to compute tight upper bounds on the JSR and CJSR and to compute the spectral radius of individual matrices, each based on utilities from SwitchOnSafety.jl.","category":"page"},{"location":"stability/","page":"Stability","title":"Stability","text":"spectral_radius\njsr\ncjsr","category":"page"},{"location":"stability/#ThresholdStability.spectral_radius","page":"Stability","title":"ThresholdStability.spectral_radius","text":"spectral_radius(A::AbstractMatrix)\n\nCalculates the spectral radius of matrix A.\n\n\n\n\n\n","category":"function"},{"location":"stability/#ThresholdStability.jsr","page":"Stability","title":"ThresholdStability.jsr","text":"jsr(Σ::AbstractVector{<:AbstractMatrix}; d = 2)\n\nCalculates an upper bound on the joint spectral radius of a set of matrices Σ.\n\njsr(s::AbstractSwitchedSystem; d = 2)\n\nCalculates an upper bound on the joint spectral radius for the switched linear system s.\n\n\n\n\n\n","category":"function"},{"location":"stability/#ThresholdStability.cjsr","page":"Stability","title":"ThresholdStability.cjsr","text":"cjsr(Σ::AbstractVector{<:AbstractMatrix}, G::AbstractAutomaton; d = 2)\n\nCalculates an upper bound on the constrained joint spectral radius of the constrained switched system (Σ, G).\n\ncjsr(s::AbstractSwitchedSystem; d = 2)\n\nCalculates an upper bound on the constrained joint spectral radius of the switched system s.\n\n\n\n\n\n","category":"function"},{"location":"stability/","page":"Stability","title":"Stability","text":"The jsr function applied to a state-dependent switched system (\\Sigma, G, X) or a constrained switched system (\\Sigma, G) ignores the state-space constraints and automaton and reports the JSR of \\Sigma. Likewise, the cjsr function applied to a state-dependent switched system ignores the state-space constraints. Applying the cjsr function to an unconstrained system is equivalent to applying jsr.","category":"page"},{"location":"stability/","page":"Stability","title":"Stability","text":"For information on how to construct switched systems s, please see the HybridSystems documentation or see the examples/src folder.","category":"page"},{"location":"stability/#SCJSR","page":"Stability","title":"SCJSR","text":"","category":"section"},{"location":"stability/","page":"Stability","title":"Stability","text":"This package contains two methods to compute upper bounds on the SCJSR, one solving a semidefinite program (SDP) directly and another solving a sum of squares (SOS) program.","category":"page"},{"location":"stability/","page":"Stability","title":"Stability","text":"sosbound_γ\nsosbound_gamma\nsdpbound_γ\nsdpbound_gamma","category":"page"},{"location":"stability/#ThresholdStability.sosbound_γ","page":"Stability","title":"ThresholdStability.sosbound_γ","text":"sosbound_γ(s::StateDepDiscreteSwitchedLinearSystem, d)\n\nCompute minimum value of γ for which the sum-of-squares program is feasible.\n\nKeywords\n\noptimizer=...: choose an SDP solver. The default solver is CSDP.\ntol=...: set tolerance. The default is tol=1e-5.\nverbose=...: set level of detail reported during calculation process. The default is verbose=0.\ninitstep=...: set initial step size. The default value is initstep=1.1.\n\n\n\n\n\n","category":"function"},{"location":"stability/#ThresholdStability.sosbound_gamma","page":"Stability","title":"ThresholdStability.sosbound_gamma","text":"sosbound_gamma(s::StateDepDiscreteSwitchedLinearSystem, d; optimizer=nothing, tol=1e-5, verbose=0, initstep=1.1)\n\nAlias for sosbound_γ.\n\n\n\n\n\n","category":"function"},{"location":"stability/#ThresholdStability.sdpbound_γ","page":"Stability","title":"ThresholdStability.sdpbound_γ","text":"sdpbound_γ(s::StateDepDiscreteSwitchedLinearSystem)\n\nCompute minimum value of gamma for which the SDP is feasible.\n\nFor keywords, see sosbound_γ\n\n\n\n\n\n","category":"function"},{"location":"stability/#ThresholdStability.sdpbound_gamma","page":"Stability","title":"ThresholdStability.sdpbound_gamma","text":"sdpbound_gamma(s::StateDepDiscreteSwitchedLinearSystem; optimizer=nothing, tol=1e-5, verbose=0, initstep=1.1)\n\nAlias for sdpbound_γ.\n\n\n\n\n\n","category":"function"},{"location":"stability/","page":"Stability","title":"Stability","text":"Since each mathscrX_i is a convex polyhedron described by two matrices, E_i and D_i, each state space constraints should be supplied as the matrix pair [E_i, D_i]. For example, suppose we have a model","category":"page"},{"location":"stability/","page":"Stability","title":"Stability","text":"beginaligned\ny_t^*=phi_1^*y_t-1^*+phi_1y_t-1+phi_2^*y_t-1^*+phi_2y_t-1+epsilon_t\ny_t=maxy_t^*0\nendaligned","category":"page"},{"location":"stability/","page":"Stability","title":"Stability","text":"This can be described either by a 3-dimensional state vector (y_t^* y_t-1^* y_t-1) and a set of two 3times3 matrices, or by a 2-dimensional state vector (y_t^* y_t-1^*) and a set of four 2times2 matrices:","category":"page"},{"location":"stability/","page":"Stability","title":"Stability","text":"In the former case, the state space constraints are encoded as","category":"page"},{"location":"stability/","page":"Stability","title":"Stability","text":"E_1, E_2, E_3, E_4 = [1 0 0.; 0 1 0.], [1 0 0.; 0 -1 0.], [-1 0 0.; 0 1 0.], [-1 0 0.; 0 -1 0.]\nD_1, D_3 = [0 1 -1.], [0 1 -1.]; D_2, D_4 = [0 0 1.], [0 0 1.]\nX = [[E_1, D_1], [E_2, D_2], [E_3, D_3], [E_4, D_4]]\n\n# output\n4-element Vector{Vector{Matrix{Float64}}}:\n [[1.0 0.0 0.0; 0.0 1.0 0.0], [0.0 1.0 -1.0]]\n [[1.0 0.0 0.0; 0.0 -1.0 0.0], [0.0 0.0 1.0]]\n [[-1.0 0.0 0.0; 0.0 1.0 0.0], [0.0 1.0 -1.0]]\n [[-1.0 0.0 0.0; 0.0 -1.0 0.0], [0.0 0.0 1.0]]","category":"page"},{"location":"stability/","page":"Stability","title":"Stability","text":"The matrices E_i describe the state space constraints on (y_t^*y_t-1^*) and the matrices D_i enforce the constraint that x_t-1=maxx_t-1^*0.","category":"page"},{"location":"stability/","page":"Stability","title":"Stability","text":"In the latter case, the state space constraints are encoded as","category":"page"},{"location":"stability/","page":"Stability","title":"Stability","text":"E_1, E_2, E_3, E_4 = [1 0.; 0 1.], [1 0.; 0 -1.], [-1 0.; 0 1.], [-1 0.; 0 -1.]\nD_1 = zeros(1,2); D_2, D_3, D_4 = copy(D_1), copy(D_1), copy(D_1)\nX = [[E_1, D_1], [E_2, D_2], [E_3, D_3], [E_4, D_4]]\n\n# output\n4-element Vector{Vector{Matrix{Float64}}}:\n [[1.0 0.0; 0.0 1.0], [0.0 0.0]]\n [[1.0 0.0; 0.0 -1.0], [0.0 0.0]]\n [[-1.0 0.0; 0.0 1.0], [0.0 0.0]]\n [[-1.0 0.0; 0.0 -1.0], [0.0 0.0]]","category":"page"},{"location":"stability/","page":"Stability","title":"Stability","text":"Here, each D_i is a matrix of zeros since there are no censored variables in the state vector.","category":"page"},{"location":"stability/#SCJSR-calculation-details","page":"Stability","title":"SCJSR calculation details","text":"","category":"section"},{"location":"stability/#SDP-program","page":"Stability","title":"SDP program","text":"","category":"section"},{"location":"stability/","page":"Stability","title":"Stability","text":"The upper bound on the SCJSR found by sdpbound_γ involves finding the minimum value of the scalar gamma s.t. the semidefinite program","category":"page"},{"location":"stability/","page":"Stability","title":"Stability","text":"beginaligned\nQ_i-E_i^TU_iE_i+D_i^TZ_iD_isucc0qquadtextfor i=1dotsm\ngamma^2Q_i-A_sigma^TQ_jA_sigma-E_i^TU_ijE_i+D_i^TZ_ijD_isucceq0qquadtextfor (ijsigma)in G\nendaligned","category":"page"},{"location":"stability/","page":"Stability","title":"Stability","text":"is feasible, where U_igeq0, U_ijgeq0, Z_isucc0 and Z_ijsucc0 are otherwise arbitrary. Here, geq denotes element-wise inequality, Asucc0 indicates A is positive definite and Asucceq0 indicates A is positive semidefinite.","category":"page"},{"location":"stability/#SOS-program","page":"Stability","title":"SOS program","text":"","category":"section"},{"location":"stability/","page":"Stability","title":"Stability","text":"The upper bound on the SCJSR found using sosbound_γ is generally less conservative than that found by sdpbound_γ; sosbound_γ is thus recommended.","category":"page"},{"location":"stability/","page":"Stability","title":"Stability","text":"As in Parillo and Jadbabaie, 2008, let x^d denote the d-lift of vector x and let A^d be defined as the matrix such that (Ax)^d=A^dx^d. Let y=x^d. Now, sosbound_γ involves finding gamma that minimizes","category":"page"},{"location":"stability/","page":"Stability","title":"Stability","text":"beginaligned\ny^tQ_iy-(E_i^dy)^TU_iE_i^dy+(D_i^dy)^TZ_iD_i^dy-y^Tytext is SOSqquadtextfor i=1dotsm\ngamma^2dy^TQ_iy=(A_sigma^dy)^TQ_jA_sigma^dy\nqquad-(E_i^dy)^TU_ij^dE_i^dy+(D_i^dy)^TZ_ijD_i^dytext is SOSqquadtextfor (ijsigma)in G\nendaligned","category":"page"},{"location":"stability/","page":"Stability","title":"Stability","text":"where U_igeq0, U_ijgeq0, Z_isucc0 and Z_ijsucc0.","category":"page"},{"location":"","page":"Home","title":"Home","text":"CurrentModule = ThresholdStability","category":"page"},{"location":"#ThresholdStability","page":"Home","title":"ThresholdStability","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"ThresholdStability.jl is a package implementing techniques to determine the stability of discrete-time threshold vector autoregressive (TVAR) models.","category":"page"},{"location":"#Contents","page":"Home","title":"Contents","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Pages = [\"cksvar.md\", \"stability.md\"]\nDepth = 2","category":"page"},{"location":"#Index","page":"Home","title":"Index","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"","category":"page"}]
}

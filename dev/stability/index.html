<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Stability · ThresholdStability.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">ThresholdStability.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Stability</a><ul class="internal"><li><a class="tocitem" href="#Motivation"><span>Motivation</span></a></li><li><a class="tocitem" href="#JSR-and-CJSR"><span>JSR and CJSR</span></a></li><li><a class="tocitem" href="#SCJSR"><span>SCJSR</span></a></li><li><a class="tocitem" href="#SCJSR-calculation-details"><span>SCJSR calculation details</span></a></li></ul></li><li><a class="tocitem" href="../cksvar/">CKSVAR</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Stability</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Stability</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/samwycherley/ThresholdStability.jl/blob/master/docs/src/stability.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Stability"><a class="docs-heading-anchor" href="#Stability">Stability</a><a id="Stability-1"></a><a class="docs-heading-anchor-permalink" href="#Stability" title="Permalink"></a></h1><h2 id="Motivation"><a class="docs-heading-anchor" href="#Motivation">Motivation</a><a id="Motivation-1"></a><a class="docs-heading-anchor-permalink" href="#Motivation" title="Permalink"></a></h2><p>Let <span>$\{\mathscr{X}_i\}_{i=1}^m$</span> be a partition of state space <span>$\mathscr{X}\subseteq\mathbb{R}^p$</span> s.t. each <span>$\mathscr{X}_i$</span> takes the form of a convex polyhedron,</p><p class="math-container">\[\mathscr{X}_i=\{x\in\mathbb{R}^p\mid E_ix\geq_* 0, D_ix=0\},\]</p><p>where the inequality <span>$\geq_*$</span> may be strict or weak.</p><p>The tools in <a href="https://github.com/samwycherley/ThresholdStability.jl">ThresholdStability.jl</a> are intended to determine whether a discrete-time model of form</p><p class="math-container">\[\begin{aligned}x_{t+1}&amp;=\Phi(x_t)x_t\\
&amp;:=\sum_{\sigma=1}^mA_\sigma\mathbf{1}\{x_t\in\mathscr{X}_i\}x_t\end{aligned}\]</p><p>is asymptotically stable, where <span>$\mathbf{1}\{x\in\mathscr{X}_i\}$</span> is an indicator function and <span>$A_i$</span> are given <span>$p\times p$</span> matrices.</p><p>Sufficient conditions for asymptotic stability, in descending order of conservativeness, are that</p><ul><li>the <em>joint spectral radius</em> (JSR) of the set <span>$\Sigma=\{A_1,\dots,A_m\}$</span> is strictly less than 1;</li><li>the <em>constrained joint spectral radius</em> (CJSR) of the constrained switched linear system <span>$(\Sigma, G)$</span>, where <span>$G$</span> is an automaton describing the possible transitions between states, is strictly less than 1;</li><li>the &#39;<em>state-constrained joint spectral radius</em>&#39; (SCJSR) of the state-dependent switched linear system <span>$(\Sigma, G, \{\mathscr{X}_i\})$</span> is strictly less than 1.</li></ul><p>In general, exact computation of the JSR, CJSR and SCJSR are NP-hard, but can be efficiently approximated via semidefinite programming or sum-of-squares programming (see e.g. <a href="https://arxiv.org/abs/0712.2887">Parillo and Jadbabaie, 2008</a>).</p><h2 id="JSR-and-CJSR"><a class="docs-heading-anchor" href="#JSR-and-CJSR">JSR and CJSR</a><a id="JSR-and-CJSR-1"></a><a class="docs-heading-anchor-permalink" href="#JSR-and-CJSR" title="Permalink"></a></h2><p>We provide functions to compute tight upper bounds on the JSR and CJSR and to compute the spectral radius of individual matrices, each based on utilities from <a href="https://github.com/blegat/SwitchOnSafety.jl">SwitchOnSafety.jl</a>.</p><article class="docstring"><header><a class="docstring-binding" id="ThresholdStability.spectral_radius" href="#ThresholdStability.spectral_radius"><code>ThresholdStability.spectral_radius</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">spectral_radius(A::AbstractMatrix)</code></pre><p>Calculates the spectral radius of matrix <code>A</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/samwycherley/ThresholdStability.jl/blob/f020bafc1bf79430b6a4e9e902d440399f1ed9a3/src/ThresholdStability.jl#L13-L17">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThresholdStability.jsr" href="#ThresholdStability.jsr"><code>ThresholdStability.jsr</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">jsr(Σ::AbstractVector{&lt;:AbstractMatrix}; d = 2)</code></pre><p>Calculates an upper bound on the joint spectral radius of a set of matrices <code>Σ</code>.</p><pre><code class="nohighlight hljs">jsr(s::AbstractSwitchedSystem; d = 2)</code></pre><p>Calculates an upper bound on the joint spectral radius for the switched linear system <code>s</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/samwycherley/ThresholdStability.jl/blob/f020bafc1bf79430b6a4e9e902d440399f1ed9a3/src/ThresholdStability.jl#L22-L30">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThresholdStability.cjsr" href="#ThresholdStability.cjsr"><code>ThresholdStability.cjsr</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">cjsr(Σ::AbstractVector{&lt;:AbstractMatrix}, G::AbstractAutomaton; d = 2)</code></pre><p>Calculates an upper bound on the constrained joint spectral radius of the constrained switched system <code>(Σ, G)</code>.</p><pre><code class="nohighlight hljs">cjsr(s::AbstractSwitchedSystem; d = 2)</code></pre><p>Calculates an upper bound on the constrained joint spectral radius of the switched system <code>s</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/samwycherley/ThresholdStability.jl/blob/f020bafc1bf79430b6a4e9e902d440399f1ed9a3/src/ThresholdStability.jl#L34-L42">source</a></section></article><p>The <code>jsr</code> function applied to a state-dependent switched system <code>(\Sigma, G, X)</code> or a constrained switched system <code>(\Sigma, G)</code> ignores the state-space constraints and automaton and reports the JSR of <code>\Sigma</code>. Likewise, the <code>cjsr</code> function applied to a state-dependent switched system ignores the state-space constraints. Applying the <code>cjsr</code> function to an unconstrained system is equivalent to applying <code>jsr</code>.</p><p>For information on how to construct switched systems <code>s</code>, please see the <a href="https://blegat.github.io/HybridSystems.jl/stable/lib/methods/#Switched-Systems-1">HybridSystems documentation</a> or see the <a href="https://github.com/samwycherley/ThresholdStability.jl/tree/master/examples/src">examples/src folder</a>.</p><h2 id="SCJSR"><a class="docs-heading-anchor" href="#SCJSR">SCJSR</a><a id="SCJSR-1"></a><a class="docs-heading-anchor-permalink" href="#SCJSR" title="Permalink"></a></h2><p>This package contains two methods to compute upper bounds on the SCJSR, one solving a semidefinite program (SDP) directly and another solving a sum of squares (SOS) program.</p><article class="docstring"><header><a class="docstring-binding" id="ThresholdStability.sosbound_γ" href="#ThresholdStability.sosbound_γ"><code>ThresholdStability.sosbound_γ</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">sosbound_γ(s::StateDepDiscreteSwitchedLinearSystem, d)</code></pre><p>Compute minimum value of <span>$γ$</span> for which the sum-of-squares program is feasible.</p><p><strong>Keywords</strong></p><ul><li><code>optimizer=...</code>: choose an SDP solver. The default solver is CSDP.</li><li><code>tol=...</code>: set tolerance. The default is <code>tol=1e-5</code>.</li><li><code>verbose=...</code>: set level of detail reported during calculation process. The default is <code>verbose=0</code>.</li><li><code>initstep=...</code>: set initial step size. The default value is <code>initstep=1.1</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/samwycherley/ThresholdStability.jl/blob/f020bafc1bf79430b6a4e9e902d440399f1ed9a3/src/sos_gamma_search.jl#L51-L61">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThresholdStability.sosbound_gamma" href="#ThresholdStability.sosbound_gamma"><code>ThresholdStability.sosbound_gamma</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">sosbound_gamma(s::StateDepDiscreteSwitchedLinearSystem, d; optimizer=nothing, tol=1e-5, verbose=0, initstep=1.1)</code></pre><p>Alias for <a href="#ThresholdStability.sosbound_γ"><code>sosbound_γ</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/samwycherley/ThresholdStability.jl/blob/f020bafc1bf79430b6a4e9e902d440399f1ed9a3/src/sos_gamma_search.jl#L76-L80">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThresholdStability.sdpbound_γ" href="#ThresholdStability.sdpbound_γ"><code>ThresholdStability.sdpbound_γ</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">sdpbound_γ(s::StateDepDiscreteSwitchedLinearSystem)</code></pre><p>Compute minimum value of <span>$\gamma$</span> for which the SDP is feasible.</p><p>For keywords, see <a href="#ThresholdStability.sosbound_γ"><code>sosbound_γ</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/samwycherley/ThresholdStability.jl/blob/f020bafc1bf79430b6a4e9e902d440399f1ed9a3/src/sdp_gamma_search.jl#L45-L51">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ThresholdStability.sdpbound_gamma" href="#ThresholdStability.sdpbound_gamma"><code>ThresholdStability.sdpbound_gamma</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">sdpbound_gamma(s::StateDepDiscreteSwitchedLinearSystem; optimizer=nothing, tol=1e-5, verbose=0, initstep=1.1)</code></pre><p>Alias for <a href="#ThresholdStability.sdpbound_γ"><code>sdpbound_γ</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/samwycherley/ThresholdStability.jl/blob/f020bafc1bf79430b6a4e9e902d440399f1ed9a3/src/sdp_gamma_search.jl#L67-L71">source</a></section></article><p>Since each <span>$\mathscr{X}_i$</span> is a convex polyhedron described by two matrices, <code>E_i</code> and <code>D_i</code>, each state space constraints should be supplied as the matrix pair <code>[E_i, D_i]</code>. For example, suppose we have a model</p><p class="math-container">\[begin{aligned}
y_t^*&amp;=\phi_1^*y_{t-1}^*+\phi_1y_{t-1}+\phi_2^*y_{t-1}^*+\phi_2y_{t-1}+\epsilon_t,\\
y_t&amp;=\max\{y_t^*,0\}.
\end{aligned}\]</p><p>This can be described either by a 3-dimensional state vector <span>$(y_t^*, y_{t-1}^*, y_{t-1})$</span> and a set of two <span>$3\times3$</span> matrices, or by a 2-dimensional state vector <span>$(y_t^*, y_{t-1}^*)$</span> and a set of four <span>$2\times2$</span> matrices:</p><ul><li>In the former case, the state space constraints are encoded as</li></ul><pre><code class="language-julia hljs">E_1, E_2, E_3, E_4 = [1 0 0.; 0 1 0.], [1 0 0.; 0 -1 0.], [-1 0 0.; 0 1 0.], [-1 0 0.; 0 -1 0.]
D_1, D_3 = [0 1 -1.], [0 1 -1.]; D_2, D_4 = [0 0 1.], [0 0 1.]
X = [[E_1, D_1], [E_2, D_2], [E_3, D_3], [E_4, D_4]]

# output
4-element Vector{Vector{Matrix{Float64}}}:
 [[1.0 0.0 0.0; 0.0 1.0 0.0], [0.0 1.0 -1.0]]
 [[1.0 0.0 0.0; 0.0 -1.0 0.0], [0.0 0.0 1.0]]
 [[-1.0 0.0 0.0; 0.0 1.0 0.0], [0.0 1.0 -1.0]]
 [[-1.0 0.0 0.0; 0.0 -1.0 0.0], [0.0 0.0 1.0]]</code></pre><p>The matrices <code>E_i</code> describe the state space constraints on <span>$(y_t^*,y_{t-1}^*)$</span> and the matrices <code>D_i</code> enforce the constraint that <span>$x_{t-1}=\max\{x_{t-1}^*,0\}$</span>.</p><ul><li>In the latter case, the state space constraints are encoded as</li></ul><pre><code class="language-julia hljs">E_1, E_2, E_3, E_4 = [1 0.; 0 1.], [1 0.; 0 -1.], [-1 0.; 0 1.], [-1 0.; 0 -1.]
D_1 = zeros(1,2); D_2, D_3, D_4 = copy(D_1), copy(D_1), copy(D_1)
X = [[E_1, D_1], [E_2, D_2], [E_3, D_3], [E_4, D_4]]

# output
4-element Vector{Vector{Matrix{Float64}}}:
 [[1.0 0.0; 0.0 1.0], [0.0 0.0]]
 [[1.0 0.0; 0.0 -1.0], [0.0 0.0]]
 [[-1.0 0.0; 0.0 1.0], [0.0 0.0]]
 [[-1.0 0.0; 0.0 -1.0], [0.0 0.0]]</code></pre><p>Here, each <code>D_i</code> is a matrix of zeros since there are no censored variables in the state vector.</p><h2 id="SCJSR-calculation-details"><a class="docs-heading-anchor" href="#SCJSR-calculation-details">SCJSR calculation details</a><a id="SCJSR-calculation-details-1"></a><a class="docs-heading-anchor-permalink" href="#SCJSR-calculation-details" title="Permalink"></a></h2><h3 id="SDP-program"><a class="docs-heading-anchor" href="#SDP-program">SDP program</a><a id="SDP-program-1"></a><a class="docs-heading-anchor-permalink" href="#SDP-program" title="Permalink"></a></h3><p>The upper bound on the SCJSR found by <a href="#ThresholdStability.sdpbound_γ"><code>sdpbound_γ</code></a> involves finding the minimum value of the scalar <span>$\gamma$</span> s.t. the semidefinite program</p><p class="math-container">\[\begin{aligned}
Q_i-E_i^TU_iE_i+D_i^TZ_iD_i&amp;\succ0\qquad\text{for }i=1,\dots,m,\\
\gamma^2Q_i-A_\sigma^TQ_jA_\sigma-E_i^TU_{ij}E_i+D_i^TZ_{ij}D_i&amp;\succeq0\qquad\text{for }(i,j,\sigma)\in G,
\end{aligned}\]</p><p>is feasible, where <span>$U_i\geq0$</span>, <span>$U_{ij}\geq0$</span>, <span>$Z_i\succ0$</span> and <span>$Z_{ij}\succ0$</span> are otherwise arbitrary. Here, <span>$\geq$</span> denotes element-wise inequality, <span>$A\succ0$</span> indicates <span>$A$</span> is positive definite and <span>$A\succeq0$</span> indicates <span>$A$</span> is positive semidefinite.</p><h3 id="SOS-program"><a class="docs-heading-anchor" href="#SOS-program">SOS program</a><a id="SOS-program-1"></a><a class="docs-heading-anchor-permalink" href="#SOS-program" title="Permalink"></a></h3><p>The upper bound on the SCJSR found using <a href="#ThresholdStability.sosbound_γ"><code>sosbound_γ</code></a> is generally less conservative than that found by <a href="#ThresholdStability.sdpbound_γ"><code>sdpbound_γ</code></a>; <a href="#ThresholdStability.sosbound_γ"><code>sosbound_γ</code></a> is thus recommended.</p><p>As in <a href="https://arxiv.org/abs/0712.2887">Parillo and Jadbabaie (2008)</a>, let <span>$x^{[d]}$</span> denote the <span>$d$</span>-lift of vector <span>$x$</span> and let <span>$A^{[d]}$</span> be defined as the matrix such that <span>$(Ax)^{[d]}=A^{[d]}x^{[d]}$</span>. Let <span>$y=x^{[d]}$</span>. Now, <a href="#ThresholdStability.sosbound_γ"><code>sosbound_γ</code></a> involves finding <span>$\gamma$</span> that minimizes</p><p class="math-container">\[\begin{aligned}
y^TQ_iy-(E_i^{[d]}y)^TU_iE_i^{[d]}y+(D_i^{[d]}y)^TZ_iD_i^{[d]}y-y^Ty&amp;\enskip\text{ is SOS}\qquad\text{for }i=1,\dots,m,\\
\gamma^{2d}y^TQ_iy-(A_\sigma^{[d]}y)^TQ_jA_\sigma^{[d]}y\qquad\qquad&amp;\\
-(E_i^{[d]}y)^TU_{ij}^{[d]}E_i^{[d]}y + (D_i^{[d]}y)^TZ_{ij}D_i^{[d]}y &amp;\enskip\text{ is SOS}\qquad\text{for }(i,j,\sigma)\in G,
\end{aligned}\]</p><p>where <span>$U_i\geq0$</span>, <span>$U_{ij}\geq0$</span>, <span>$Z_i\succ0$</span> and <span>$Z_{ij}\succ0$</span>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../cksvar/">CKSVAR »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.5 on <span class="colophon-date" title="Wednesday 15 September 2021 12:25">Wednesday 15 September 2021</span>. Using Julia version 1.6.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
